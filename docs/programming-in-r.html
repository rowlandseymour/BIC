<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Programming in R | Bayesian Inference and Computation</title>
  <meta name="description" content="This book contains the lecture notes for the module Bayesian Inference and Computation." />
  <meta name="generator" content="bookdown 0.28.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Programming in R | Bayesian Inference and Computation" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/uob_logo.png" />
  <meta property="og:description" content="This book contains the lecture notes for the module Bayesian Inference and Computation." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Programming in R | Bayesian Inference and Computation" />
  
  <meta name="twitter:description" content="This book contains the lecture notes for the module Bayesian Inference and Computation." />
  <meta name="twitter:image" content="/uob_logo.png" />

<meta name="author" content="Dr Rowland Seymour" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fundamentals.html"/>
<link rel="next" href="bayesian-inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Inference and Computation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practicalities</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#module-aims"><i class="fa fa-check"></i><b>0.1</b> Module aims</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#module-structure"><i class="fa fa-check"></i><b>0.2</b> Module structure</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>0.3</b> Assessment</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i><b>0.4</b> Getting help</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#recommended-books-and-videos"><i class="fa fa-check"></i><b>0.5</b> Recommended books and videos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="fundamentals.html"><a href="fundamentals.html"><i class="fa fa-check"></i><b>1</b> Fundamentals of Bayesian inference</a>
<ul>
<li class="chapter" data-level="1.1" data-path="fundamentals.html"><a href="fundamentals.html#statistical-inference"><i class="fa fa-check"></i><b>1.1</b> Statistical Inference</a></li>
<li class="chapter" data-level="1.2" data-path="fundamentals.html"><a href="fundamentals.html#frequentist-theory"><i class="fa fa-check"></i><b>1.2</b> Frequentist Theory</a></li>
<li class="chapter" data-level="1.3" data-path="fundamentals.html"><a href="fundamentals.html#bayesian-probability"><i class="fa fa-check"></i><b>1.3</b> Bayesian probability</a></li>
<li class="chapter" data-level="1.4" data-path="fundamentals.html"><a href="fundamentals.html#conditional-probability-and-exchangability"><i class="fa fa-check"></i><b>1.4</b> Conditional Probability and Exchangability</a></li>
<li class="chapter" data-level="1.5" data-path="fundamentals.html"><a href="fundamentals.html#bayes-theorem"><i class="fa fa-check"></i><b>1.5</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="1.6" data-path="fundamentals.html"><a href="fundamentals.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-in-r.html"><a href="programming-in-r.html"><i class="fa fa-check"></i><b>2</b> Programming in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-in-r.html"><a href="programming-in-r.html#computer-lab-i"><i class="fa fa-check"></i><b>2.1</b> Computer Lab I</a></li>
<li class="chapter" data-level="2.2" data-path="programming-in-r.html"><a href="programming-in-r.html#computer-lab-ii"><i class="fa fa-check"></i><b>2.2</b> Computer Lab II</a></li>
<li class="chapter" data-level="2.3" data-path="programming-in-r.html"><a href="programming-in-r.html#computer-lab-iii"><i class="fa fa-check"></i><b>2.3</b> Computer Lab III</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>3</b> Bayesian Inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#the-binomial-distirbution"><i class="fa fa-check"></i><b>3.1</b> The Binomial Distirbution</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#reporting-conclsuions-from-bayesian-inference"><i class="fa fa-check"></i><b>3.2</b> Reporting Conclsuions from Bayesian Inference</a></li>
<li class="chapter" data-level="3.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#the-exponential-distribution"><i class="fa fa-check"></i><b>3.3</b> The Exponential Distribution</a></li>
<li class="chapter" data-level="3.4" data-path="bayesian-inference.html"><a href="bayesian-inference.html#the-normal-distribtuion"><i class="fa fa-check"></i><b>3.4</b> The Normal Distribtuion</a></li>
<li class="chapter" data-level="3.5" data-path="bayesian-inference.html"><a href="bayesian-inference.html#predicition"><i class="fa fa-check"></i><b>3.5</b> Predicition</a></li>
<li class="chapter" data-level="3.6" data-path="bayesian-inference.html"><a href="bayesian-inference.html#non-informative-prior-distibrutions"><i class="fa fa-check"></i><b>3.6</b> Non-informative Prior Distibrutions</a></li>
<li class="chapter" data-level="3.7" data-path="bayesian-inference.html"><a href="bayesian-inference.html#bernstein-von-mises-theorem"><i class="fa fa-check"></i><b>3.7</b> Bernstein-von-Mises Theorem</a></li>
<li class="chapter" data-level="3.8" data-path="bayesian-inference.html"><a href="bayesian-inference.html#exercises-1"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>4</b> Sampling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sampling.html"><a href="sampling.html#uniform-random-numbers"><i class="fa fa-check"></i><b>4.1</b> Uniform random numbers</a></li>
<li class="chapter" data-level="4.2" data-path="sampling.html"><a href="sampling.html#inverse-transform-sampling"><i class="fa fa-check"></i><b>4.2</b> Inverse transform sampling</a></li>
<li class="chapter" data-level="4.3" data-path="sampling.html"><a href="sampling.html#rejection-sampling"><i class="fa fa-check"></i><b>4.3</b> Rejection sampling</a></li>
<li class="chapter" data-level="4.4" data-path="sampling.html"><a href="sampling.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>4.4</b> Markov Chain Monte Carlo</a></li>
<li class="chapter" data-level="4.5" data-path="sampling.html"><a href="sampling.html#properties-of-markov-chains"><i class="fa fa-check"></i><b>4.5</b> Properties of Markov Chains</a></li>
<li class="chapter" data-level="4.6" data-path="sampling.html"><a href="sampling.html#gibbs-sampler"><i class="fa fa-check"></i><b>4.6</b> Gibbs Sampler</a></li>
<li class="chapter" data-level="4.7" data-path="sampling.html"><a href="sampling.html#metropolis-hastings"><i class="fa fa-check"></i><b>4.7</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="4.8" data-path="sampling.html"><a href="sampling.html#mcmc-diagnostics"><i class="fa fa-check"></i><b>4.8</b> MCMC Diagnostics</a></li>
<li class="chapter" data-level="4.9" data-path="sampling.html"><a href="sampling.html#exercises-2"><i class="fa fa-check"></i><b>4.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="advanced-computation.html"><a href="advanced-computation.html"><i class="fa fa-check"></i><b>5</b> Advanced computation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="advanced-computation.html"><a href="advanced-computation.html#heiracichal-models"><i class="fa fa-check"></i><b>5.1</b> Heiracichal Models</a></li>
<li class="chapter" data-level="5.2" data-path="advanced-computation.html"><a href="advanced-computation.html#prior-ellicitation"><i class="fa fa-check"></i><b>5.2</b> Prior Ellicitation</a></li>
<li class="chapter" data-level="5.3" data-path="advanced-computation.html"><a href="advanced-computation.html#data-augmentation"><i class="fa fa-check"></i><b>5.3</b> Data Augmentation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Inference and Computation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programming-in-r" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Programming in R<a href="programming-in-r.html#programming-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="computer-lab-i" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Computer Lab I<a href="programming-in-r.html#computer-lab-i" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This first computer lab is about getting used to R. The first step is to download R and Rstudio.</p>
<ul>
<li><a href="https://www.r-project.org">Download R</a></li>
<li><a href="https://posit.co/downloads/">Download RStudio IDE</a></li>
</ul>
<p>The easiest way to learn R is by using it to solve problems. The lab contains four exercises and three ways of approaching the exercise (easy, medium and hard). If you’re new to R, use the easy approach and copy and paste the code straight into R – you’ll need to fill in a few blanks though. If you’ve used R before, or a similar programming language, stick to the medium and hard approaches. This is also an exercise in using Google. Googling around a problem of for specific commands can allow you to quickly find examples (most likely on Stack Overflow) with code you can use.</p>
<p>There are three aims of this lab:</p>
<ol style="list-style-type: decimal">
<li>Getting used to programming in R.</li>
<li>Generating random numbers in R.</li>
<li><a href="https://www.w3schools.com/r/r_for_loop.asp">Creating for loops in R</a>.</li>
</ol>
<div class="exercise">
<p><span id="exr:unlabeled-div-28" class="exercise"><strong>Exercise 2.1  </strong></span>The changes in the Birmingham stock exchange each day can be modelled using a normal distribution. The price on day <span class="math inline">\(i\)</span>, <span class="math inline">\(X_i\)</span> is given by
<span class="math display">\[
X_i = \alpha X_{i-1}, \qquad \alpha \sim N(1.001, 0.005^2).
\]</span>
The index begins at <span class="math inline">\(X_0 = 100\)</span>. Investigate the distribution of the value of the stock market on days 50 and 100.</p>
<p><strong>Hard</strong>. Use a simulation method to generate the relevant distributions.</p>
<p><strong>Medium</strong>. Simulate the value for <span class="math inline">\(\alpha\)</span> for each of the 100 days and use the <code>cumprod</code> command to plot a trajectory. Use a for loop to repeat this 100 times and investigate the distribution of the value of the stock market on days 50 and 100.</p>
<p><strong>Easy</strong>. Fill in the blanks in the following code.</p>
<pre><code># Plot one ----------------------------------------------------------------
x &lt;- rnorm(n = , mean = , sd = ) #Simulate daily change for 100 days
plot(, type = &#39;l&#39;) #multiply each day by the previous days

# Plot 100 realisations ---------------------------------------------------
market.index &lt;- matrix(NA, 100, 100) #Initialise a matrix to store trajectories
for(i in 1:100){
  x &lt;- rnorm(n = , mean = , sd = )
  market.index [, i] &lt;- 
}

#Plot all trajectories
matplot(prices, type = &#39;l&#39;)

#Get distribution of days 50 and 100
hist()
hist()
quantile(, )
quantile(, )</code></pre>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-29" class="exercise"><strong>Exercise 2.2  </strong></span>You are an avid lottery player and play the lottery twice a week, every week for 50 years (a total of 5,200 times). The lottery has 50 balls labeled 1, …, 50 and you play the same 6 numbers each time. Six out of the 50 balls are chosen uniformly at random and the prize money is shown in the table below.</p>
<table>
<thead>
<tr class="header">
<th>Numbers Matched</th>
<th>Prize Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0-2</td>
<td>£0</td>
</tr>
<tr class="even">
<td>3</td>
<td>£30</td>
</tr>
<tr class="odd">
<td>4</td>
<td>£140</td>
</tr>
<tr class="even">
<td>5</td>
<td>£1,750</td>
</tr>
<tr class="odd">
<td>6</td>
<td>£1,000,000</td>
</tr>
</tbody>
</table>
<p>It costs you £2 to play each time. Simulate one set of 5,200 draws. How much do you win? What is your total profit/loss?</p>
<p><strong>Hard</strong>. Use a for loop and sequence of if else statements to generate your prize winnings.</p>
<p><strong>Medium</strong>. Use a for loop to generate the lottery numbers and prize winnings for each draw. Use the <code>sample</code> function to generate a set of lottery numbers and check they match against your numbers using the <code>%in%</code> function. Finally, use if else statements to check how much you have won each time.</p>
<p><strong>Easy</strong>. Fill in the blanks in the following code.</p>
<pre><code>my.numbers &lt;- 

#For loop to generate lottery numbers and prize winnings
prize &lt;- numeric(5200)
for(i in 1:5200){
  
  #Generate lottery numbers
  draw &lt;- sample(, )
  
  #Check how many match my numbers
  numbers.matched &lt;- #use %in% function
  
  #Compute prize winings
  if(numbers.matched &lt; 3)
    prize[i] &lt;- 0
  else if()
    prize[i] &lt;-  30
  else if()
    prize[i] &lt;-  140
  else if()
    prize[i] &lt;-  1750
  else
    prize[i] &lt;- 1000000
}

#Summarise prize winnings
table(prize)
hist(prize)
sum(prize) - 2*5200</code></pre>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-30" class="exercise"><strong>Exercise 2.3  </strong></span>Estimate <span class="math inline">\(\pi\)</span>.</p>
<p><strong>Hard</strong>. Use a rejection sampling algorithm.</p>
<p><strong>Medium</strong>. Generate lots of points <span class="math inline">\((x, y)\)</span> on the unit square <span class="math inline">\([0, 1]^2\)</span>. Check each point to see if it lies within the unit circle. Use the proportion of points that lie within the unit circle to estimate <span class="math inline">\(\pi\)</span>.</p>
<p><strong>Easy</strong>. Fill in the blanks in the following code.</p>
<pre><code>#Sample on unit square
N &lt;- 10000      #number of points
x &lt;-            #sample N points uniformly at random on [0, 1]
y &lt;-            #sample N points uniformly at random on [0, 1]

#Estimate pi
r.sq                 &lt;- x^2 + y^2                #check how far from origin
number.inside.circle &lt;-           #count how many points inside unit cirlce
pi.estimate          &lt;- 

#Plot points
par(pty = &quot;s&quot;)         #make sure plot is square
plot(x, y, cex = 0.1)  #plot points
theta &lt;- seq(0, pi/2, 0.01) #plot unit circle
lines(x = cos(theta), y = sin(theta), col = &quot;red&quot;)</code></pre>
<p><strong>Extra</strong>. Use a for loop to repeat this for <span class="math inline">\(N = \{1, \ldots, 10000\}\)</span>. Record the estimate for <span class="math inline">\(\pi\)</span> for each value and the relative error.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-31" class="exercise"><strong>Exercise 2.4  </strong></span>A linear congruential generator (LCG) is a simple algorithm for generating random integers. Given a starting value <span class="math inline">\(X_0\)</span>, it generates a sequence of integers according to
<span class="math display">\[
X_{i+1} = a X_i + c \mod m.
\]</span>
Software that generates numbers using an LCG Setting <span class="math inline">\(a = 3\)</span>, <span class="math inline">\(c = 2\)</span>, <span class="math inline">\(m = 7\)</span> and <span class="math inline">\(X_0 = 0\)</span>, generate 20 samples from this generator.</p>
<ol style="list-style-type: decimal">
<li><p>Investigate the ‘randomness’ of this generator by creating the delay plot, where <span class="math inline">\(X_{i-1}\)</span> is plotted against <span class="math inline">\(X_{i}\)</span></p></li>
<li><p>One way to improve the quality of these generators is to shuffle the sequence generated. Generate rate two sequences <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> from two different LCGs, and report the shuffled sequence <span class="math inline">\(Z_j = X_{Y_j}\)</span>. For the sequence <span class="math inline">\(Y\)</span> use the values <span class="math inline">\(a = 5\)</span>, <span class="math inline">\(c = 1\)</span>, <span class="math inline">\(m = 8\)</span> and <span class="math inline">\(Y_0 = 2\)</span>.</p></li>
<li><p>As the past two exercises show, LCGs are notoriously poor. in the 1960s and 70s, RANDU was a widely used LCG developed by IBM. According to Wikipedia
&gt; IBM’s RANDU is widely considered to be one of the most ill-conceived random number generators ever designed, and was described as “truly horrible” by Donald Knuth.</p></li>
</ol>
<p>The RANDU LCG uses <span class="math inline">\(a = 2^{16} + 3\)</span>, <span class="math inline">\(c = 0\)</span>, <span class="math inline">\(m = 2^{31}\)</span> and <span class="math inline">\(Y_0 = 1\)</span>. Generate a sequence of 10,000 pseudorandom variables from the RANDU LCG and create the delay plot.</p>
<p>The delay plot seems to show little relationship between <span class="math inline">\(X_{i}\)</span> and <span class="math inline">\(X_{i+1}\)</span>. The third order delay plot is a 3d-plot with coordinate <span class="math inline">\((X_i, X_{i+1}, X_{i+2})\)</span> and this plot shows a different picture. Create this plot using the code</p>
<pre><code>#install.packages(&quot;scatterplot3d&quot;) #you may need to install this package
scatterplot3d::scatterplot3d(X[1:9998], X[2:9999], X[3:10000], angle=154, 
                             xlab = expression(X[i]), ylab = expression(X[i+1]), zlab = expression(X[i+2]))</code></pre>
<p>This is what makes the RANDU LCG so poor. Write down <span class="math inline">\(X_{i+1}\)</span> and <span class="math inline">\(X_{i+2}\)</span> in terms of <span class="math inline">\(X_i\)</span>. Show that <span class="math inline">\(X_{i+2} = \alpha X_{i+1} + \beta X_{i}\)</span>.</p>
<p><strong>Hard</strong>. Use a for loop to construct sequences from the LCGs <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p><strong>Medium</strong>. Create a for loop to generate the value for the sequence <span class="math inline">\(X_i\)</span> for <span class="math inline">\(i = 1, \ldots, 20\)</span>. Modular arithmetic can be performed using the <span class="math inline">\(%%\)</span> function. Create a new for loop to construct the sequence <span class="math inline">\(Y\)</span>. To shuffle the sequence <span class="math inline">\(X\)</span> using <span class="math inline">\(Y\)</span>, you will need to subset <span class="math inline">\(X\)</span> by <span class="math inline">\(Y\)</span> in R.</p>
<p><strong>Easy</strong>. Fill in the blanks in the code below</p>
<pre><code># 1. Shuffling ---------------------------------------------------------------
X &lt;- numeric(21) #initialise vector to store X

#Set values for LCG
a &lt;- 
c &lt;- 
m &lt;- 
X[1]&lt;- 


#Run Generator
for(i in 2:21){
  X[i] &lt;-
}
X

#Delay plot
plot( , , xlab = expression(X[i-1]), ylab = expression(X[i]), type = &#39;l&#39;)



# 2. Shuffling ---------------------------------------------------------------

Y &lt;- numeric(21) #initialise vector to store Y

#Set values for LCG
a &lt;- 
c &lt;- 
m &lt;- 
Y[1]&lt;- 


#Run Generator
for(i in 2:50){
  Y[i] &lt;- 
}

#report sequence
Y
X[Y]

#Plot delay plot
plot(, , xlab = expression(Z[i-1]), ylab = expression(Z[i]), type = &#39;l&#39;)
</code></pre>
</div>
</div>
<div id="computer-lab-ii" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Computer Lab II<a href="programming-in-r.html#computer-lab-ii" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="computer-lab-iii" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Computer Lab III<a href="programming-in-r.html#computer-lab-iii" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
