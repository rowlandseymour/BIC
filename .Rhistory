y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 5000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.01^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
numerator <- exp(-0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq)
denominator <-  exp(-0.01*mu - sum(y - mu)^2/sigma.sq)
p.acc <- numerator/denominator
u <- runif(1)
if(u < p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
p.acc
numerator
mu.proposed
mu
sum(y - mu.proposed)^2/sigma.sq
exp(-0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq)
-0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
-0.01*mu - sum(y - mu)^2/sigma.sq
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
numerator - denominator
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.numerator - log.denominator
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 5000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.01^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 5000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.01^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.01^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.01
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
hist(rnorm(30, 0.5, 0.01))
hist(rnorm(30, 0.5, 0.01^2))
hist(rnorm(30, 0.5, 0.1))
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/sigma.sq
log.denominator <-  -0.01*mu - sum(y - mu)^2/sigma.sq
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/(2*sigma.sq)
log.denominator <-  -0.01*mu - sum(y - mu)^2/*2*sigma.sq)
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/(2*sigma.sq)
log.denominator <-  -0.01*mu - sum(y - mu)^2/(2*sigma.sq)
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator <- -0.01*mu.proposed - sum(y - mu.proposed)^2/(2*sigma.sq)
log.denominator <-  -0.01*mu - sum(y - mu)^2/(2*sigma.sq)
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
hist(mu.store)
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu., sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu., sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- numerator - denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
hist(rnorm(30, 0.5, 0.1))
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 50000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 5000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 10000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 10000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 1000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 1000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.05, mu + 0.05)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 1000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
y <- c(0.34, 0.47, 0.58, 0.27, 0.74, 0.44, 0.46, 0.65, 0.36, 0.55, 0.58, 0.55, 0.53, 0.56, 0.54, 0.61, 0.43, 0.52, 0.45, 0.49, 0.32, 0.33, 0.47, 0.58, 0.34, 0.60, 0.59, 0.43, 0.57, 0.34)
n.iter   <- 10000
mu.store <- numeric(n.iter)
mu <- 1
sigma.sq <- 0.1^2
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.05, mu + 0.05)
if(mu.proposed > 0){
log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = 0.1, log = TRUE)) +
dexp(mu.proposed, 0.01, log = TRUE)
log.denominator <- sum(dnorm(y, mean = mu, sd = 0.1, log = TRUE)) +
dexp(mu, 0.01, log = TRUE)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
#Set up elements for MCMC
n.iter   <- 10000
mu.store <- numeric(n.iter)
#Initial values
mu <- 1
sigma <- 0.1 #known
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.05, mu + 0.05)
if(mu.proposed > 0){
log.numerator   <- -0.01*mu.proposed - sum(y - mu.proposed^2)/(2*sigma^2)
log.denominator <- -0.01*mu - sum(y - mu^2)/(2*sigma^2)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
#Set up elements for MCMC
n.iter   <- 10000
mu.store <- numeric(n.iter)
#Initial values
mu <- 1
sigma <- 0.1 #known
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.05, mu + 0.05)
if(mu.proposed > 0){
log.numerator   <- -0.01*mu.proposed - sum(y - mu.proposed)^2/(2*sigma^2)
log.denominator <- -0.01*mu - sum(y - mu)^2/(2*sigma^2)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
# log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = sigma, log = TRUE)) +
#   dexp(mu.proposed, 0.01, log = TRUE)
# log.denominator <- sum(dnorm(y, mean = mu, sd = sigma, log = TRUE)) +
#   dexp(mu, 0.01, log = TRUE)
#Set up elements for MCMC
n.iter   <- 10000
mu.store <- numeric(n.iter)
#Initial values
mu <- 1
sigma <- 0.1 #known
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.1, mu + 0.1)
if(mu.proposed > 0){
log.numerator   <- -0.01*mu.proposed - sum(y - mu.proposed)^2/(2*sigma^2)
log.denominator <- -0.01*mu - sum(y - mu)^2/(2*sigma^2)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
# log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = sigma, log = TRUE)) +
#   dexp(mu.proposed, 0.01, log = TRUE)
# log.denominator <- sum(dnorm(y, mean = mu, sd = sigma, log = TRUE)) +
#   dexp(mu, 0.01, log = TRUE)
#Set up elements for MCMC
n.iter   <- 10000
mu.store <- numeric(n.iter)
#Initial values
mu <- 1
sigma <- 0.1 #known
for(i in 1:n.iter){
mu.proposed <- runif(1, mu - 0.01, mu + 0.01)
if(mu.proposed > 0){
log.numerator   <- -0.01*mu.proposed - sum(y - mu.proposed)^2/(2*sigma^2)
log.denominator <- -0.01*mu - sum(y - mu)^2/(2*sigma^2)
log.p.acc <- log.numerator - log.denominator
u <- runif(1)
if(log(u) < log.p.acc){
mu <- mu.proposed
}
}
mu.store[i] <- mu
}
plot(mu.store, type = 'l')
# log.numerator   <- sum(dnorm(y, mean = mu.proposed, sd = sigma, log = TRUE)) +
#   dexp(mu.proposed, 0.01, log = TRUE)
# log.denominator <- sum(dnorm(y, mean = mu, sd = sigma, log = TRUE)) +
#   dexp(mu, 0.01, log = TRUE)
hist(mu.store[-c(1:100)])
hist(mu.store[-c(1:1000)])
plot(mu.store[c(1:1000)], type = 'l')
plot(mu.store[-c(1:1000)], type = 'l')
acf(mu.store[-c(1:1000)])
usethis::use_git_config(user.name = "rowlandseymour", user.email = "rowlandseymour@gmail.com")
install.packages("usethis")
usethis::use_git_config(user.name = "rowlandseymour", user.email x= "rowlandseymour@gmail.com")
usethis::use_git_config(user.name = "rowlandseymour", user.email = "rowlandseymour@gmail.com")
usethis::create_github_token()
credentials::set_github_pat("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")
usethis::edit_r_environ()
